{% extends "base.html" %}
{% block title %}Home - LibraCore{% endblock %}
{% block content %}

<section class="min-h-[80vh] flex items-center justify-center relative overflow-hidden">

  <div class="particles"></div>

  <div class="grid md:grid-cols-2 gap-6 items-center w-full max-w-6xl z-20 relative">

    <!-- ================= ROBOT ================= -->
    <div class="flex justify-center relative z-10">

      <div class="robot" id="robot">

        <!-- HEAD -->
        <div class="robot-head">
          <div class="eyes">
            <span class="eye"></span>
            <span class="eye"></span>
          </div>
          <div class="mouth neutral"></div>
        </div>

        <!-- BODY -->
        <div class="robot-body">
          <div class="arm left"></div>
          <div class="torso"></div>
          <div class="arm right" id="robotArm"></div>
        </div>

        <!-- LEGS -->
        <div class="legs">
          <span></span><span></span>
        </div>
      </div>
    </div>

    <!-- ================= MENU ================= -->
    <div class="flex flex-col gap-4 items-start relative z-30">

      <h2 class="text-3xl font-bold">
        Welcome to <span class="text-cyan-400">Libra</span><span class="text-pink-400">Core</span>
      </h2>

      {% if role == 'admin' %}
      <a href="{{ url_for('maintenance') }}" class="action-btn">
         Maintenance
      </a>
      {% endif %}

      <a href="{{ url_for('transactions') }}" class="action-btn">
         Transactions
      </a>

      <a href="{{ url_for('reports') }}" class="action-btn">
         Reports
      </a>

    </div>
  </div>
</section>

<!-- ================= STYLES ================= -->
<style>

/* BUTTONS */
.action-btn{
  padding:14px 22px;
  border-radius:16px;
  background:linear-gradient(135deg,#22d3ee,#a78bfa);
  color:#020617;
  font-weight:700;
  box-shadow:0 12px 30px rgba(99,102,241,.45);
  transition:.3s;
}
.action-btn:hover{
  transform:translateY(-3px) scale(1.04);
  box-shadow:0 18px 45px rgba(99,102,241,.7);
}

/* ROBOT */
.robot{
  transform:scale(1.25);
  animation:float 4s ease-in-out infinite;
}
@keyframes float{
  0%,100%{ transform:translateY(0) scale(1.25); }
  50%{ transform:translateY(-10px) scale(1.25); }
}

.robot-head{
  width:160px;height:120px;
  background:linear-gradient(135deg,#38bdf8,#818cf8);
  border-radius:28px;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  box-shadow:0 0 45px rgba(56,189,248,.6);
}
.eyes{
  display:flex;
  gap:28px;
  position: relative; /* âœ… ADD THIS */
}

.eye{
  width: 14px;
  height: 14px;
  background: #020617;
  border-radius: 50%;

  /* ðŸ‘€ BOTH effects combined */
  transform:
    translate(var(--eye-x, 0px), var(--eye-y, 0px))
    scaleY(var(--blink, 1));

  transition: transform 0.08s linear;
  animation: blink 5s infinite;
}




.mouth{
  width:30px;
  height:6px;
  background:#020617;
  border-radius:6px;
  margin-top:10px;
  transition:.25s;
}
.mouth.happy{ width:36px; height:8px; }
.mouth.surprise{ width:10px; height:16px; border-radius:50%; }

.robot-body{ display:flex; align-items:center; margin-top:12px; }
.torso{
  width:90px;height:110px;
  background:#020617;border-radius:22px;
}
.arm{ width:16px;height:80px;background:#38bdf8;border-radius:10px; }
.arm.left{ margin-right:10px; animation:armSwing 3s infinite; }
.arm.right{
  margin-left:10px;
  transform-origin:top center;
  transition:.25s;
}

.legs{ display:flex; gap:20px; justify-content:center; margin-top:8px; }
.legs span{
  width:14px;height:50px;background:#64748b;border-radius:10px;
  animation:legMove 2s infinite;
}

/* PARTICLES */
.particles::before{
  content:"";
  position:absolute;
  inset:0;
  background:
    radial-gradient(circle at 20% 30%, rgba(56,189,248,.25), transparent 40%),
    radial-gradient(circle at 80% 60%, rgba(168,139,250,.25), transparent 40%);
  animation: drift 10s infinite alternate;
}
@keyframes drift{
  from{ transform:translateY(0); }
  to{ transform:translateY(-20px); }
}

/* ANIMS */
@keyframes armSwing{
  0%,100%{ transform:rotate(0); }
  50%{ transform:rotate(6deg); }
}
@keyframes legMove{
  0%,100%{ transform:translateY(0); }
  50%{ transform:translateY(4px); }
}

/* EYE BLINK */
@keyframes blink{
  0%,95%,100%{ --blink: 1; }
  97%{ --blink: .15; }
}

.eye{ animation:blink 5s infinite; }

</style>

<!-- ================= SCRIPT ================= -->
<script>
  const eyes = document.querySelectorAll(".eye");
  const arm = document.getElementById("robotArm");
  const mouth = document.querySelector(".mouth");

  /* ================= EYES FOLLOW CURSOR (FIXED) ================= */
  document.addEventListener("mousemove", (e) => {
    eyes.forEach((eye) => {
      const rect = eye.getBoundingClientRect();

      const eyeCenterX = rect.left + rect.width / 2;
      const eyeCenterY = rect.top + rect.height / 2;

      const dx = e.clientX - eyeCenterX;
      const dy = e.clientY - eyeCenterY;

      const angle = Math.atan2(dy, dx);

      const moveX = Math.cos(angle) * 4; // max movement
      const moveY = Math.sin(angle) * 4;

      /* âœ… IMPORTANT: use CSS variables instead of transform */
      eye.style.setProperty("--eye-x", `${moveX}px`);
      eye.style.setProperty("--eye-y", `${moveY}px`);
    });
  });

  /* ================= HAND + FACE LOGIC ================= */
  document.querySelectorAll(".action-btn").forEach((btn) => {

    btn.addEventListener("mouseenter", () => {
      const rect = btn.getBoundingClientRect();
      const armRect = arm.getBoundingClientRect();

      const dx = rect.left - armRect.left;
      const dy = rect.top - armRect.top;
      const angle = Math.atan2(dy, dx) * (180 / Math.PI);

      arm.style.transform = `rotate(${angle}deg)`;
      mouth.className = "mouth happy";
    });

    btn.addEventListener("mouseleave", () => {
      arm.style.transform = "rotate(0deg)";
      mouth.className = "mouth neutral";
    });

    btn.addEventListener("click", () => {
      mouth.className = "mouth surprise";
      arm.style.transform = "rotate(35deg)";

      setTimeout(() => {
        arm.style.transform = "rotate(0deg)";
        mouth.className = "mouth happy";
      }, 300);
    });

  });
</script>

  

{% endblock %}
